<view class="screen profile-screen">
  <scroll-view class="profile-scroll" scroll-y="true" show-scrollbar="false">
    <view style="height: {{topInset}}px;"></view>
    <view class="top-grab"></view>

    <view class="user-row">
      <view class="avatar">
        <image wx:if="{{avatarUrl}}" class="avatar-img" src="{{avatarUrl}}" mode="aspectFill"></image>
        <text wx:else>{{avatarText}}</text>
      </view>
      <view class="user-info">
        <view class="name">{{nickname}}</view>
        <view class="id">ID: {{userId || '--'}}</view>
      </view>
      <view class="setting" bindtap="openProfileActions">⚙</view>
    </view>

    <view class="card summary-card">
      <view class="summary-head">🏆 累计战绩 <text class="positive">{{totalScore}}</text></view>
      <view class="stat-grid">
        <view class="stat-box">
          <view class="num">{{totalRounds}}</view>
          <view class="label">总局数</view>
        </view>
        <view class="stat-box">
          <view class="num">{{winRate}}</view>
          <view class="label">胜率</view>
        </view>
        <view class="stat-box">
          <view class="num positive">{{totalWin}}</view>
          <view class="label">总盈利</view>
        </view>
        <view class="stat-box">
          <view class="num negative">{{totalLoss}}</view>
          <view class="label">总亏损</view>
        </view>
      </view>
    </view>

    <view class="card ratio-card">
      <view class="ratio-head">
        <view class="positive">赢 {{winCount}}局</view>
        <view class="negative">输 {{loseCount}}局</view>
      </view>
      <view class="ratio-bar">
        <view class="win" style="width: {{winPercent}}%;"></view>
        <view class="lose" style="width: {{losePercent}}%;"></view>
      </view>
    </view>

    <view class="card menu-card">
      <view class="menu-item" bindtap="goHistory">
        <view class="menu-left">
          <view class="menu-icon">📖</view>
          <view>
            <view class="menu-title">历史记录</view>
            <view class="menu-sub">查看所有房间记录</view>
          </view>
        </view>
        <view class="menu-arrow">></view>
      </view>

      <view class="divider"></view>

      <view class="menu-item" bindtap="goManual">
        <view class="menu-left">
          <view class="menu-icon">?</view>
          <view>
            <view class="menu-title">使用手册</view>
            <view class="menu-sub">如何使用打牌记账</view>
          </view>
        </view>
        <view class="menu-arrow">></view>
      </view>
    </view>

    <view class="version">打牌记账 v1.0.0</view>
    <view class="bottom-space"></view>
  </scroll-view>

  <view class="bottom-nav">
    <view class="nav-item" bindtap="goHome">
      <view class="nav-icon">¤</view>
      <view class="nav-text">记账</view>
    </view>
    <view class="nav-item active">
      <view class="nav-icon">◌</view>
      <view class="nav-text">我的</view>
    </view>
  </view>
</view>
